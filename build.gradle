apply plugin: 'java'
apply plugin: 'findbugs'
apply plugin: 'checkstyle'

sourceSets {
    main {
        java {
            srcDir 'exercises'
        }
    }
}

tasks.withType(JavaCompile) {
    options.compilerArgs << "-Xlint:deprecation"
}

tasks.withType(FindBugs) {
    reports {
        xml.enabled = false
        html.enabled = true
    }
}

tasks.withType(Checkstyle) {
    reports {
        xml.enabled = false
        html.enabled = true
    }
}

ext {
    wrapper = file('run.sh')
}

dependencies {
    compile project(':algs4')
    runtime project(':algs4')
    repositories {
        mavenCentral()
    }
}

build {
    inputs.files sourceSets.main.runtimeClasspath
    outputs.file wrapper
}

build.doLast {
    wrapper.withPrintWriter {
        it.println '#!/bin/sh'
        it.println "time java -cp ${getRuntimeClasspath()} \$@"
    }
    wrapper.setExecutable(true)
}

clean {
    delete wrapper
}

String getRuntimeClasspath() {
    sourceSets.main.runtimeClasspath.collect { it.absolutePath }.join(':')
}
